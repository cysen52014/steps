var Control=function(t){function e(){t.call(this),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight,this.isNext=!0}__extends(e,t);var s=(__define,e),i=s.prototype;return i.addTouchEvent=function(t){this.square=t.square;var e=RES.getRes("ocs_json");this.shpc=new egret.Shape,this.shpc.graphics.beginFill(16711680,1),this.shpc.graphics.drawRect(0,0,this.stageW,this.stageH),this.shpc.graphics.endFill(),this.shpc.alpha=0,this.shpc.touchEnabled=!0,this.shpc.pixelHitTest=!0,this.addChild(this.shpc),this.shpc.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation(),this.isNext&&(this.isNext=!1,this.checkStep(t.stageX,t.stageY))},this),this.leftbtn=new egret.Bitmap,this.leftbtn.texture=e.getTexture("sa_6"),this.leftbtn.x=48,this.leftbtn.y=490,this.addChild(this.leftbtn),this.rightbtn=new egret.Bitmap,this.rightbtn.texture=e.getTexture("sa_7"),this.rightbtn.x=egret.MainContext.instance.stage.stageWidth-this.leftbtn.width-48,this.rightbtn.y=490,this.addChild(this.rightbtn)},i.checkStep=function(t,e){t>this.stageW/2?this.square.run(this,2):this.square.run(this,1)},e}(egret.DisplayObjectContainer);egret.registerClass(Control,"Control");var GameoverLayer=function(t){function e(){t.call(this),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight,this.pai_json=RES.getRes("pai_json"),this.pai_png=RES.getRes("pai_png")}__extends(e,t);var s=(__define,e),i=s.prototype;return i.createLayer=function(t){this.oParent=t,this.shpcy=new egret.Shape,this.shpcy.graphics.beginFill(16711680,1),this.shpcy.graphics.drawRect(0,0,this.stageW,this.stageH),this.shpcy.graphics.endFill(),this.shpcy.alpha=0,this.shpcy.touchEnabled=!0,this.shpcy.pixelHitTest=!0,this.addChild(this.shpcy),this.ocss=RES.getRes("ocs_json"),this.yxjx=new egret.Bitmap,this.yxjx.texture=this.ocss.getTexture("sa_8"),this.yxjx.x=(egret.MainContext.instance.stage.stageWidth-this.yxjx.width)/2,this.yxjx.y=48,this.addChild(this.yxjx),this.restBtn=new egret.Bitmap,this.restBtn.texture=this.ocss.getTexture("sa_12"),this.restBtn.x=(egret.MainContext.instance.stage.stageWidth-this.restBtn.width)/2-300,this.restBtn.y=498,this.restBtn.name="start",this.restBtn.touchEnabled=!0,this.addChild(this.restBtn);var e=new egret.MovieClipDataFactory(this.pai_json,this.pai_png);this.pai_mc=new egret.MovieClip(e.generateMovieClipData("syc")),this.pai_mc.x=egret.MainContext.instance.stage.stageWidth/2+265,this.pai_mc.y=375,this.pai_mc.play(-1),this.addChild(this.pai_mc),this.rto=new egret.Bitmap,this.rto.texture=this.ocss.getTexture("sa_9"),this.rto.x=(egret.MainContext.instance.stage.stageWidth-this.rto.width)/2-176,this.rto.y=250,this.addChild(this.rto),this.qpo=new egret.Bitmap,this.qpo.texture=this.ocss.getTexture("sa_11"),this.qpo.x=(egret.MainContext.instance.stage.stageWidth-this.qpo.width)/2-320,this.qpo.y=168,this.qpo.touchEnabled=!0,this.addChild(this.qpo),this.ydu=new egret.Bitmap,this.ydu.texture=this.ocss.getTexture("sa_13"),this.ydu.x=(egret.MainContext.instance.stage.stageWidth-this.ydu.width)/2,this.ydu.y=498,this.ydu.touchEnabled=!0,this.addChild(this.ydu),this.diy=new egret.Bitmap,this.diy.texture=this.ocss.getTexture("sa_14"),this.diy.x=(egret.MainContext.instance.stage.stageWidth-this.diy.width)/2+300,this.diy.y=498,this.diy.touchEnabled=!0,this.addChild(this.diy),this.qotxt=new egret.Bitmap,this.qotxt.texture=this.ocss.getTexture("sa_10"),this.qotxt.x=(egret.MainContext.instance.stage.stageWidth-this.qotxt.width)/2-330,this.qotxt.y=198,this.addChild(this.qotxt),this.ldimg=new egret.Bitmap,this.ldimg.width=100,this.ldimg.height=100,this.ldimg.anchorOffsetX=50,this.ldimg.anchorOffsetY=50,this.ldimg.rotation=8,this.ldimg.x=egret.MainContext.instance.stage.stageWidth/2-165,this.ldimg.y=248,this.addChild(this.ldimg);var s=new egret.Shape;s.graphics.beginFill(255),s.graphics.drawCircle(50,50,50),s.graphics.endFill(),s.anchorOffsetX=50,s.anchorOffsetY=50,s.x=egret.MainContext.instance.stage.stageWidth/2-165,s.y=248,this.addChild(s),this.ldimg.mask=s,this.poplayer=new popLayer,this.poplayer.creatUl(this.oParent),this.poplayer.visible=!1,this.addChild(this.poplayer),this.qpo.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showPopShop,this),this.diy.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showDiy,this),this.ydu.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showShareTips,this),this.shpcy.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation()}),this.setPhoto()},i.showPopShop=function(t){t.stopImmediatePropagation(),this.poplayer.visible=!0,this.poplayer.hidePops(),this.poplayer.showPops(1),this.poplayer.ldimg.visible=!1},i.showDiy=function(t){this.visible=!0,t.stopImmediatePropagation(),callJsShowUpLoadBotton(1),this.poplayer.blei=2,this.poplayer.visible=!0,this.poplayer.ldimg.visible=!0,this.poplayer.hidePops(),this.poplayer.showPops(3)},i.showShareTips=function(t){t.stopImmediatePropagation(),callJsShareFun(1)},i.setPhoto=function(){var t=this;""!=InterfaceData.photos&&RES.getResByUrl(InterfaceData.photos,function(e){var s=e;t.ldimg.texture=s},this,RES.ResourceItem.TYPE_IMAGE)},e}(egret.Sprite);egret.registerClass(GameoverLayer,"GameoverLayer");var Gold=function(t){function e(){t.call(this),this.currGoldNum=0,this.goldArr={},this.goldNum=0}__extends(e,t);var s=(__define,e),i=s.prototype;return i.creatGold=function(){this.ocs=RES.getRes("ocs_json"),this.gold=new egret.Bitmap,this.bestgoldNum=null==egret.localStorage.getItem("bestGoldNum")?"0":egret.localStorage.getItem("bestGoldNum"),this.gold.texture=this.ocs.getTexture("gold"),this.gold.x=25,this.gold.y=30,this.addChild(this.gold),this.gdNum=new egret.BitmapText,this.gdNum.font=RES.getRes("goldnum_fnt"),this.gdNum.x=88,this.gdNum.y=32,this.addChild(this.gdNum),this.plus=new egret.BitmapText,this.plus.font=RES.getRes("goldnum_fnt"),this.plus.text="+1",this.plus.y=180,this.plus.x=170,this.plus.alpha=0,this.addChild(this.plus),this.getGoldCount()},i.getGoldCount=function(){var t=parseInt(this.bestgoldNum)+this.goldNum;this.gdNum.text=t,this.currGoldNum=t,egret.localStorage.setItem("bestGoldNum",t.toString())},i.addSquareGold=function(t,e){var s=new egret.Bitmap;s.texture=this.ocs.getTexture("gold"),e.addChild(s),s.x=t.x-20,s.y=t.y-90,this.goldArr[t.idx]=s,this.updwon(s)},i.updwon=function(t){var e=egret.Tween.get(t,{loop:!0});e.to({y:t.y-20},600).to({y:t.y},600)},i.delGold=function(t){t.gold&&(this.goldNum++,this.getGoldCount(),this.addPlus(t.x),this.goldArr[t.idx].visible=!1)},i.addPlus=function(t){this.plus.alpha=1,this.plus.y=180;var e=egret.Tween.get(this.plus);e.to({y:this.plus.y-100,alpha:0},600)},e}(egret.Sprite);egret.registerClass(Gold,"Gold");var LoadingUI=function(t){function e(){t.call(this),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight,this.createView()}__extends(e,t);var s=(__define,e),i=s.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=100,this.textField.textColor=5724248,this.textField.x=(egret.MainContext.instance.stage.stageWidth-this.textField.width)/2,this.textField.y=(egret.MainContext.instance.stage.stageHeight-this.textField.height)/2,this.textField.textAlign="center",RES.getResByUrl("http://res.weixin.737.com/theme/121/gamesteps/css/img/sa_30.png?v=1",function(t){var e=t;this.textFieldTpis=new egret.Bitmap,this.textFieldTpis.texture=e,this.textFieldTpis.scaleX=1.5,this.textFieldTpis.scaleY=1.5,this.textFieldTpis.x=(egret.MainContext.instance.stage.stageWidth-this.textFieldTpis.width)/2-75,this.textFieldTpis.y=(egret.MainContext.instance.stage.stageHeight-this.textFieldTpis.height)/2+10,this.addChild(this.textFieldTpis)},this,RES.ResourceItem.TYPE_IMAGE)},i.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.isStart=!1,this.isck=!1,this.isOpenMusic=!1,this.musicChose=1,this.pageIndex=0,this.MusicCurId=1,this.micArrList=[{bgc:[0,38.219]},{one:[43,43.298],two:[43.4,43.69],three:[43.695,44.21],yy:[43,44.21]},{one:[48.6,49],two:[49.18,49.5],three:[49.56,50.08],yy:[48.6,50.08]},{one:[38.3,38.598],two:[38.7,38.9],three:[38.998,39.696],yy:[38.3,39.696]},{one:[40,40.299],two:[40.4,40.6],three:[40.612,41.397],yy:[40,41.397]},{one:[41.497,41.798],two:[41.898,42.1],three:[42.1,42.79],yy:[41.497,42.79]},{one:[44.5,44.74],two:[44.9,44.98],three:[45,46.3],yy:[44.5,46.3]},{one:[46.492,46.789],two:[46.9,47.14],three:[47.2,48.478],yy:[46.492,48.478]},{one:[50.2,50.486],two:[50.6,50.767],three:[50.786,51.646],yy:[50.2,51.646]},{one:[52,52.182],two:[52.233,52.547],three:[52.646,53.587],yy:[52,53.587]},{one:[53.7,54],two:[54.105,54.345],three:[54.4,55.238],yy:[53.7,55.238]},{one:[55.5,55.86],two:[55.916,56.279],three:[56.449,57.792],yy:[55.5,57.792]},{one:[58,58.319],two:[58.495,58.712],three:[58.74,61.774],yy:[58,61.774]},{one:[62,62.318],two:[62.495,62.79],three:[62.83,65.939],yy:[62,65.939]},{one:[65.984,66.4],two:[66.567,66.887],three:[66.939,69.05],yy:[65.984,69.05]},{one:[69.193,69.382],two:[69.492,69.681],three:[69.732,70.83],yy:[69.093,70.83]},{one:[71,71.29],two:[71.395,71.645],three:[71.669,72.408],yy:[71,72.408]},{one:[72.498,72.815],two:[72.905,73.221],three:[73.249,74.16],yy:[72.498,74.16]}],this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var s=(__define,e),i=s.prototype;return i.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("http://res.weixin.737.com/theme/121/gamesteps/resource/default.res.json","http://res.weixin.737.com/theme/121/gamesteps/resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},i.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},i.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},i.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},i.showUl=function(){var t=this;if(1==this.pageIndex)this.control.visible=!0,this.score.visible=!0,this.gold.visible=!0;else if(2==this.pageIndex){this.GameoverLayer.visible=!0,this.score.visible=!0,this.score.bmpText.alpha=0;var e=egret.Tween.get(this.score.bmpText);e.to({alpha:1,y:200},100),t.GameoverLayer.restBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.gameRestart,t)}else 3==this.pageIndex&&(this.square.visible=!0,this.control.visible=!0,this.person.visible=!0,this.person.y=0,this.score.visible=!0,this.score.bmpText.y=20)},i.hideUl=function(){if(1==this.pageIndex){this.startLayer.shp.visible=!1;var t=egret.Tween.get(this.startLayer.startBtn),e=this.startLayer.startBtn;t.to({y:this.startLayer.startBtn.y+450},100).call(function(){e.visible=!1});var s=egret.Tween.get(this.startLayer.lwsays);s.to({alpha:0,y:this.startLayer.lwsays.y-200},100)}else 2==this.pageIndex?(this.square.visible=!1,this.score.visible=!1,this.control.visible=!1):3==this.pageIndex&&(this.GameoverLayer.visible=!1)},i.createGameScene=function(){InterfaceData.musicId>0?this.MusicCurId=InterfaceData.musicId:this.MusicCurId=1;var t=this.createBitmapByName("bg_jpg");this.addChild(t);var e=egret.MainContext.instance.stage.stageWidth,s=egret.MainContext.instance.stage.stageHeight;t.width=e,t.height=s,this.score=new Score,this.score.visible=!1,this.addChild(this.score),this.gold=new Gold,this.gold.visible=!1,this.gold.creatGold(this),this.addChild(this.gold),this.person=new Person,this.addChild(this.person),this.soundcotrol=new SoundsCtrol,this.soundcotrol.visible=!1,this.soundcotrol.creatSence(this),this.addChild(this.soundcotrol),this.MisicUl=new MisicUl,this.addChild(this.MisicUl),this.MisicUl.onAddToStage(this),this.square=new Square,this.square.init(this),this.addChild(this.square),this.control=new Control,this.control.visible=!1,this.addChild(this.control),this.control.addTouchEvent(this),this.GameoverLayer=new GameoverLayer,this.GameoverLayer.createLayer(this),this.GameoverLayer.visible=!1,this.addChild(this.GameoverLayer),this.startLayer=new StartLayer,this.startLayer.createUl(this),this.addChild(this.startLayer),this.startLayer.startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startFunc,this)},i.startFunc=function(t){t.stopImmediatePropagation(),this.musicChose=2,this.pageIndex=1,this.gold.visible=!0,this.MisicUl.loop=!1,this.MisicUl.stopMiuc(),this.hideUl(),this.showUl()},i.createBitmapByName=function(t){var e=new egret.Bitmap,s=RES.getRes(t);return e.texture=s,e},i.gameOver=function(){this.pageIndex=2,this.control.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.control.touchHandler,this.control),callJsGameOverFun(this),this.hideUl(),this.showUl(),this.person.addPhotos(),this.score.showBestScore()},i.gameRestart=function(t){this.removeChildren(),this.GameoverLayer.restBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.gameRestart,this),this.control.isNext=!0,this.score.hideBestScore(),this.musicChose=2,this.pageIndex=3,this.MisicUl.stopMiuc(),this.createGameScene(),this.gold.visible=!0,this.showUl(),this.hideUl()},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var MisicUl=function(t){function e(){t.call(this),this.isOpenMusic=!1,this.begMusic=!0,this.loop=!1,this.st=0,this.end=0,this.callback=null}__extends(e,t);var s=(__define,e),i=s.prototype;return i.onAddToStage=function(t){this.oParent=t,this.isOpenMusic=t.isOpenMusic,this._sound=RES.getRes("music_mp3"),this._channel=this._sound.play(),this._channel.stop(),this.t=new egret.Timer(30,0)},i.changeMusic=function(t,e){this.st=t,this.end=e,this.isOpenMusic&&(this.stopMiuc(),this._channel=this._sound.play(this.st),this.t.addEventListener(egret.TimerEvent.TIMER,this.soundPosition,this),this.t.reset(),this.t.start())},i.soundPosition=function(){this._channel.position>=this.end&&(this.t.stop(),this.t.removeEventListener(egret.TimerEvent.TIMER,this.soundPosition,this),this.loop?this.changeMusic(this.st,this.end):this._channel.stop(),this.oParent.square.isMusicEnd=!0,this.oParent.soundcotrol.isToMusic=!0,this.callback&&this.callback())},i.playMusic=function(){if(this.isOpenMusic){var t=this.choseMusic();1==t?(this.loop=!0,this.changeMusic(this.oParent.micArrList[0].bgc[0],this.oParent.micArrList[0].bgc[1])):2==t?(this.loop=!1,this.stopMiuc(),this.changeMusic(75,75.1)):3==t?(this.loop=!0,this.stopMiuc(),this.changeMusic(75,110)):4==t&&(this.loop=!1,this.stopMiuc(),this.changeMusic(75,75.1))}else this._channel.stop(),this.t.removeEventListener(egret.TimerEvent.TIMER,this.soundPosition,this)},i.stopMiuc=function(){this._channel.stop(),this.t.removeEventListener(egret.TimerEvent.TIMER,this.soundPosition,this)},i.choseMusic=function(){return this.oParent.musicChose},e}(egret.DisplayObjectContainer);egret.registerClass(MisicUl,"MisicUl");var Person=function(t){function e(){t.call(this),this.person_json=RES.getRes("person_json"),this.person_png=RES.getRes("person_png"),this.person_mc=null,this.personX=60,this.persoxY=127,this.creatPerson()}__extends(e,t);var s=(__define,e),i=s.prototype;return i.creatPerson=function(){var t=new egret.MovieClipDataFactory(this.person_json,this.person_png);this.person_mc=new egret.MovieClip(t.generateMovieClipData("towstep")),this.person_mc.x=this.personX,this.person_mc.y=this.persoxY,this.addChild(this.person_mc),this.addToux=new egret.Bitmap,this.addToux.width=80,this.addToux.height=80,this.addToux.anchorOffsetX=40,this.addToux.anchorOffsetY=40,this.addToux.x=198,this.addToux.y=221,this.addChild(this.addToux),this.circle=new egret.Shape,this.circle.graphics.beginFill(255),this.circle.graphics.drawCircle(40,40,40),this.circle.graphics.endFill(),this.circle.anchorOffsetX=40,this.circle.anchorOffsetY=40,this.circle.x=198,this.circle.y=221,this.addChild(this.circle),this.addToux.mask=this.circle,this.addPhotos()},i.steps=function(){this.person_mc.gotoAndPlay(5),this.person_mc.addEventListener(egret.Event.ENTER_FRAME,this.upd,this)},i.upd=function(){7==this.person_mc.currentFrame&&this.person_mc.gotoAndPlay(5)},i.playStep=function(t){switch(egret.Tween.removeTweens(this),this.ppcd=egret.Tween.get(this),this.person_mc.removeEventListener(egret.Event.ENTER_FRAME,this.upd,this),t){case 2:this.person_mc.gotoAndPlay(1),this.ppcd.to({y:-40},120).to({y:0},120),this.person_mc.addEventListener(egret.Event.ENTER_FRAME,this.oneStep,this);break;case 1:this.person_mc.gotoAndPlay(7),this.ppcd.to({y:-40},120).to({y:0},120),this.person_mc.addEventListener(egret.Event.ENTER_FRAME,this.twoStep,this)}},i.oneStep=function(t){var e,s,i=this;e=i.person_mc.movieClipData.frames[i.person_mc.currentFrame-1].y-i.person_mc.movieClipData.frames[i.person_mc.currentFrame].y,s=i.person_mc.movieClipData.frames[i.person_mc.currentFrame-1].x-i.person_mc.movieClipData.frames[i.person_mc.currentFrame].x,e>=0?(e=e>6?-6:e,s=s>10?10:s):(e=Math.abs(e)>6?-6:e,s=Math.abs(e)>10?10:e),this.person_mc.currentFrame>=5&&(this.person_mc.gotoAndStop(1),this.person_mc.removeEventListener(egret.Event.ENTER_FRAME,this.oneStep,this)),InterfaceData.photos&&(i.addToux.y=221-e,i.addToux.x=198+s,i.circle.y=221-e,i.circle.x=198+s)},i.twoStep=function(t){var e,s,i=this,h=0;h=i.person_mc.currentFrame>9?9:i.person_mc.currentFrame,e=i.person_mc.movieClipData.frames[h-1].y-i.person_mc.movieClipData.frames[h].y,s=i.person_mc.movieClipData.frames[h-1].x-i.person_mc.movieClipData.frames[h].x,e>=0?(e=e>6?-6:e,s=s>10?10:s):(e=Math.abs(e)>6?-6:e,s=Math.abs(e)>10?10:e),this.person_mc.currentFrame>=10&&(this.person_mc.gotoAndStop(1),this.person_mc.removeEventListener(egret.Event.ENTER_FRAME,this.twoStep,this)),InterfaceData.photos&&(i.addToux.y=221-e,i.addToux.x=198+s,i.circle.y=221-e,i.circle.x=198+s)},i.addPhotos=function(){""!=InterfaceData.photos&&RES.getResByUrl(InterfaceData.photos,function(t){var e=t;this.addToux.texture=e},this,RES.ResourceItem.TYPE_IMAGE)},e}(egret.Sprite);egret.registerClass(Person,"Person");var popLayer=function(t){function e(){t.call(this),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight}__extends(e,t);var s=(__define,e),i=s.prototype;return i.creatUl=function(t){this.oParent=t,this.masker=new egret.Shape,this.masker.graphics.beginFill(0,1),this.masker.graphics.drawRect(0,0,this.stageW,this.stageH),this.masker.graphics.endFill(),this.masker.width=this.stageW,this.masker.height=this.stageH,this.masker.alpha=.5,this.masker.pixelHitTest=!0,this.masker.touchEnabled=!0,this.masker.visible=!0,this.addChild(this.masker);var e=RES.getRes("ocs_json");this.boxlf=new egret.Bitmap,this.boxlf.texture=e.getTexture("sa_15"),this.boxlf.x=egret.MainContext.instance.stage.stageWidth/2-this.boxlf.width+this.boxlf.width/2-15,this.boxlf.y=330,this.boxlf.scaleX=1.1,this.boxlf.scaleY=1.1,this.boxlf.anchorOffsetX=180,this.boxlf.anchorOffsetY=239,this.boxlf.visible=!1,this.addChild(this.boxlf),this.boxrt=new egret.Bitmap,this.boxrt.texture=e.getTexture("sa_15"),this.boxrt.x=egret.MainContext.instance.stage.stageWidth/2+this.boxlf.width/2+15,this.boxrt.y=330,this.boxrt.scaleX=1.1,this.boxrt.scaleY=1.1,this.boxrt.anchorOffsetX=180,this.boxrt.anchorOffsetY=239,this.boxrt.rotation=180,this.boxrt.visible=!1,this.addChild(this.boxrt),this.closeButton=new egret.Bitmap,this.closeButton.texture=e.getTexture("Ad_close"),this.closeButton.name="x1",this.closeButton.scaleX=1.5,this.closeButton.scaleY=1.5,this.closeButton.anchorOffsetX=36,this.closeButton.anchorOffsetY=34,this.closeButton.x=egret.MainContext.instance.stage.stageWidth/2+360,this.closeButton.y=95,this.closeButton.visible=!1,this.closeButton.touchEnabled=!0,this.addChild(this.closeButton),this.goods=new ScrollBar,this.goods.x=egret.MainContext.instance.stage.stageWidth/2-340,this.goods.y=100,this.goods.visible=!1,this.goods.creatGloup(this),this.oParent.mdGoods=this.goods,this.addChild(this.goods),this.yanzi=new egret.Bitmap,this.yanzi.texture=e.getTexture("sa_18"),this.yanzi.scaleX=1.1,this.yanzi.scaleY=1.1,this.yanzi.x=egret.MainContext.instance.stage.stageWidth/2-330,this.yanzi.y=120,this.yanzi.visible=!1,this.addChild(this.yanzi),this.xrto=new egret.Bitmap,this.xrto.texture=e.getTexture("sa_9"),this.xrto.scaleX=1.5,this.xrto.scaleY=1.5,this.xrto.x=egret.MainContext.instance.stage.stageWidth/2-310,this.xrto.y=255,this.xrto.visible=!1,this.addChild(this.xrto),this.ldimg=new egret.Bitmap,this.ldimg.width=100,this.ldimg.height=100,this.ldimg.anchorOffsetX=50,this.ldimg.anchorOffsetY=50,this.ldimg.rotation=8,this.ldimg.x=egret.MainContext.instance.stage.stageWidth/2-215,this.ldimg.y=277,this.addChild(this.ldimg);var s=new egret.Shape;s.graphics.beginFill(255),s.graphics.drawCircle(50,50,50),s.graphics.endFill(),s.anchorOffsetX=50,s.anchorOffsetY=50,s.x=egret.MainContext.instance.stage.stageWidth/2-215,s.y=277,this.addChild(s),this.ldimg.mask=s,this.xwenzi=new egret.Bitmap,this.xwenzi.texture=e.getTexture("sa_19"),this.xwenzi.scaleX=1.1,this.xwenzi.scaleY=1.1,this.xwenzi.x=egret.MainContext.instance.stage.stageWidth/2-110,this.xwenzi.y=280,this.xwenzi.visible=!1,this.addChild(this.xwenzi),this.xwen2=new egret.Bitmap,this.xwen2.texture=e.getTexture("sa_26"),this.xwen2.scaleX=1.2,this.xwen2.scaleY=1.2,this.xwen2.x=(egret.MainContext.instance.stage.stageWidth-this.xwen2.width)/2+60,this.xwen2.visible=!1,this.xwen2.y=260,this.addChild(this.xwen2),this.sctx=new egret.Bitmap,this.sctx.texture=e.getTexture("sa_20"),this.sctx.scaleX=1.5,this.sctx.scaleY=1.5,this.sctx.x=(egret.MainContext.instance.stage.stageWidth-this.sctx.width)/2-50,this.sctx.visible=!1,this.sctx.y=440,this.addChild(this.sctx),this.cxsc=new egret.Bitmap,this.cxsc.texture=e.getTexture("sa_27"),this.cxsc.scaleX=1.4,this.cxsc.scaleY=1.4,this.cxsc.x=(egret.MainContext.instance.stage.stageWidth-this.cxsc.width)/2-50,this.cxsc.visible=!1,this.cxsc.y=440,this.addChild(this.cxsc),this.qued=new egret.Bitmap,this.qued.texture=e.getTexture("sa_28"),this.qued.scaleX=1.4,this.qued.scaleY=1.4,this.qued.x=(egret.MainContext.instance.stage.stageWidth-this.qued.width)/2+185,this.qued.y=440,this.qued.visible=!1,this.qued.touchEnabled=!0,this.addChild(this.qued),this.x3closeButton=new egret.Bitmap,this.x3closeButton.texture=e.getTexture("Ad_close"),this.x3closeButton.name="x2",this.x3closeButton.scaleX=1.5,this.x3closeButton.scaleY=1.5,this.x3closeButton.anchorOffsetX=36,this.x3closeButton.anchorOffsetY=34,this.x3closeButton.visible=!1,this.x3closeButton.x=egret.MainContext.instance.stage.stageWidth/2+360,this.x3closeButton.y=95,this.x3closeButton.touchEnabled=!0,this.addChild(this.x3closeButton),this.x4closeButton=new egret.Bitmap,this.x4closeButton.texture=e.getTexture("Ad_close"),this.x4closeButton.name="x3",this.x4closeButton.scaleX=1.5,this.x4closeButton.scaleY=1.5,this.x4closeButton.anchorOffsetX=36,this.x4closeButton.anchorOffsetY=34,this.x4closeButton.visible=!1,this.x4closeButton.x=egret.MainContext.instance.stage.stageWidth/2+360,this.x4closeButton.y=95,this.x4closeButton.touchEnabled=!0,this.addChild(this.x4closeButton),this.xboxlf=new egret.Bitmap,this.xboxlf.texture=e.getTexture("sa_15"),this.xboxlf.x=egret.MainContext.instance.stage.stageWidth/2-160,this.xboxlf.y=330,this.xboxlf.anchorOffsetX=180,this.xboxlf.anchorOffsetY=239,this.xboxlf.scaleX=.9,this.xboxlf.scaleY=.9,this.xboxlf.visible=!1,this.addChild(this.xboxlf),this.xboxrt=new egret.Bitmap,this.xboxrt.texture=e.getTexture("sa_15"),this.xboxrt.x=egret.MainContext.instance.stage.stageWidth/2+160,this.xboxrt.y=330,this.xboxrt.anchorOffsetX=180,this.xboxrt.anchorOffsetY=239,this.xboxrt.scaleX=.9,this.xboxrt.scaleY=.9,this.xboxrt.rotation=180,this.xboxrt.visible=!1,this.addChild(this.xboxrt),this.xxnew=new egret.Bitmap,this.xxnew.texture=e.getTexture("sa_16"),this.xxnew.scaleX=1.5,this.xxnew.scaleY=1.5,this.xxnew.x=(egret.MainContext.instance.stage.stageWidth-this.xxnew.width)/2-95,this.xxnew.visible=!1,this.xxnew.y=200,this.addChild(this.xxnew),this.xxbo=new egret.Bitmap,this.xxbo.texture=e.getTexture("sa_17"),this.xxbo.scaleX=1.5,this.xxbo.scaleY=1.5,this.xxbo.x=(egret.MainContext.instance.stage.stageWidth-this.xxbo.width)/2-30,this.xxbo.y=390,this.xxbo.touchEnabled=!0,this.xxbo.visible=!1,this.addChild(this.xxbo),this.xcloseButton=new egret.Bitmap,this.xcloseButton.texture=e.getTexture("Ad_close"),this.xcloseButton.x=egret.MainContext.instance.stage.stageWidth/2+290,this.xcloseButton.y=130,this.xcloseButton.scaleX=1.5,this.xcloseButton.scaleY=1.5,this.xcloseButton.anchorOffsetX=36,this.xcloseButton.anchorOffsetY=34,this.xcloseButton.touchEnabled=!0,this.xcloseButton.visible=!1,this.addChild(this.xcloseButton),this.xcloseButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation(),callJsShowUpLoadBotton(2),this.hidePops(),this.showPops(1)},this),this.x3closeButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation(),callJsShowUpLoadBotton(1),this.oParent.GameoverLayer.setPhoto(),this.visible=!1,this.setPhoto(),callJsShowUpLoadBotton(2)},this),this.closeButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation(),callJsShowUpLoadBotton(2),this.oParent.GameoverLayer.visible=!0,this.oParent.startLayer.musicPlay.visible=!0,this.oParent.GameoverLayer.setPhoto(),this.visible=!1},this),this.xxbo.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation(),callJsDownLoadFunc()},this),this.x4closeButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.visible=!1,this.oParent.GameoverLayer.setPhoto(),callJsShowUpLoadBotton(2)},this),this.qued.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation(),this.oParent.soundcotrol.visible=!0,this.oParent.GameoverLayer.visible=!1,this.oParent.score.visible=!1,this.oParent.gold.visible=!1,this.oParent.musicChose=4,this.oParent.MisicUl.loop=!1,this.oParent.MisicUl.stopMiuc(),this.oParent.soundcotrol.addTx(this),callJsShowUpLoadBotton(2)},this),this.setPhoto(),this.masker.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.remveEvent,this)},i.remveEvent=function(t){t.stopImmediatePropagation(),this.masker.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.remveEvent,this)},i.showPops=function(t){1==t?(this.goods.visible=!0,this.boxlf.visible=!0,this.boxrt.visible=!0,this.closeButton.visible=!0):2==t?(this.xboxlf.visible=!0,this.xboxrt.visible=!0,this.xxnew.visible=!0,this.xxbo.visible=!0,this.xcloseButton.visible=!0):3==t?(this.boxlf.visible=!0,this.boxrt.visible=!0,this.yanzi.visible=!0,this.xrto.visible=!0,this.xwenzi.visible=!0,this.sctx.visible=!0,this.x3closeButton.visible=!0):4==t&&(this.yanzi.visible=!0,this.boxlf.visible=!0,this.boxrt.visible=!0,this.xrto.visible=!0,this.cxsc.visible=!0,this.qued.visible=!0,this.xwen2.visible=!0,this.x4closeButton.visible=!0)},i.hidePops=function(){this.xboxlf.visible=!1,this.xboxrt.visible=!1,this.xxnew.visible=!1,this.xxbo.visible=!1,this.xcloseButton.visible=!1,this.goods.visible=!1,this.boxlf.visible=!1,this.boxrt.visible=!1,this.closeButton.visible=!1,this.cxsc.visible=!1,this.qued.visible=!1,this.xwen2.visible=!1,this.boxlf.visible=!1,this.boxrt.visible=!1,this.yanzi.visible=!1,this.xrto.visible=!1,this.xwenzi.visible=!1,this.sctx.visible=!1,this.x3closeButton.visible=!1,this.xwenzi.visible=!1,this.x4closeButton.visible=!1},i.hideLayer=function(){this.masker.visible=!1},i.showLayer=function(){this.masker.visible=!0},i.setPhoto=function(){""!=InterfaceData.photos&&RES.getResByUrl(InterfaceData.photos,function(t){var e=t;this.ldimg.texture=e},this,RES.ResourceItem.TYPE_IMAGE)},e}(egret.Sprite);egret.registerClass(popLayer,"popLayer");var Score=function(t){function e(){t.call(this),this.scoreCount=0,this.addBmpLabel()}__extends(e,t);var s=(__define,e),i=s.prototype;return i.TotalScore=function(t){this.scoreCount=t,this.bmpText.text=this.scoreCount.toString(),this.getBestScore(t)},i.getBestScore=function(t){t>parseInt(this.bestScore)&&(this.bestScore=t),egret.localStorage.setItem("bestScore",this.bestScore.toString())},i.addBmpLabel=function(){this.ocss=RES.getRes("ocs_json"),this.bmpText=new egret.BitmapText,this.bmpText.font=RES.getRes("num2_fnt"),this.bmpText.text=this.scoreCount.toString(),this.bmpText.x=(egret.MainContext.instance.stage.stageWidth-this.bmpText.width)/2,this.bmpText.y=20,this.addChild(this.bmpText),this.bestFont=new egret.Bitmap,this.bestFont.texture=this.ocss.getTexture("best"),this.bestFont.x=(egret.MainContext.instance.stage.stageWidth-this.bestFont.width)/2-15,this.bestFont.y=300,this.bestFont.visible=!1,this.addChild(this.bestFont),this.bestSteps=new egret.BitmapText,this.bestSteps.font=RES.getRes("goldnum_fnt"),this.bestSteps.text="0",this.bestSteps.visible=!1,this.bestSteps.x=(egret.MainContext.instance.stage.stageWidth-this.bestSteps.width)/2+50,this.bestSteps.y=305,this.addChild(this.bestSteps),this.bestScore=null==egret.localStorage.getItem("bestScore")?"0":egret.localStorage.getItem("bestScore")},i.showBestScore=function(){this.bestSteps.text=this.bestScore,this.bestSteps.visible=!0,this.bestFont.visible=!0},i.hideBestScore=function(){this.bestSteps.text=this.bestScore,this.bestSteps.visible=!1},e}(egret.Sprite);egret.registerClass(Score,"Score");var ScrollBar=function(t){function e(){t.call(this),this.wpgs=14,this.rg=4,this.goodsSoundEnd=!0}__extends(e,t);var s=(__define,e),i=s.prototype;return i.creatGloup=function(t){this.oParent=t.oParent;for(var e,s,i,h,o,n=new eui.Group,a=RES.getRes("goods_json"),r=this,c=0;c<this.wpgs;c++)i=Math.floor(c/this.rg),s=Math.floor(c%this.rg),e=new eui.Group,e.width=150,e.height=190,e.x=s*e.width+20,e.y=i*e.height,h=new egret.Bitmap,h.texture=a.getTexture("lb_"+(c+1)),o=130*(h.height/h.width),h.y=(e.height-o)/2,h.x=(e.width-130)/2,h.name=c,h.width=130,h.height=o,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){e.stopImmediatePropagation(),t.hidePops(),t.showPops(2);var s=parseInt(e.target.name);r.playsound(s)}),e.addChild(h),n.addChild(e);var l=new eui.Scroller;l.width=680,l.height=445,l.viewport=n,this.addChild(l)},i.playsound=function(t){var e=[17,16,15,14,13,11,10,9,12,8,2,7,6,1],s=this.oParent.micArrList[e[t]].yy[0],i=this.oParent.micArrList[e[t]].yy[1],h=this.oParent.startLayer;h.musicPlay.texture=h.occ.getTexture("sa_5"),h.music.loop=!1,h.music.isOpenMusic=!0,h.oParent.isOpenMusic=!0,h.music.callback=function(){h.music.callback=null,h.music.musicChose=3,h.music.stopMiuc(),h.music.playMusic()},this.oParent.MisicUl.changeMusic(s,i)},e}(eui.UILayer);egret.registerClass(ScrollBar,"ScrollBar");var SoundsCtrol=function(t){function e(){t.call(this),this.isToMusic=!0}__extends(e,t);var s=(__define,e),i=s.prototype;return i.creatSence=function(t){this.oParent=t,this.shpcy=new egret.Shape,this.shpcy.graphics.beginFill(0,1),this.shpcy.graphics.drawRect(0,0,egret.MainContext.instance.stage.stageWidth,egret.MainContext.instance.stage.stageHeight),this.shpcy.graphics.endFill(),this.shpcy.alpha=.1,this.shpcy.touchEnabled=!0,this.shpcy.pixelHitTest=!0,this.addChild(this.shpcy),this.isSelectMiusic=null==egret.localStorage.getItem("isSelectMiusic")?"0":egret.localStorage.getItem("isSelectMiusic"),this.shpcy.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation()
},this),this.ocss=RES.getRes("ocs_json"),this.TextF1=new egret.Bitmap,this.TextF1.texture=this.ocss.getTexture("sa_21"),this.TextF1.x=(egret.MainContext.instance.stage.stageWidth-this.TextF1.width)/2,this.TextF1.y=48,this.TextF1.visible=!0,this.addChild(this.TextF1),this.cgMusic=new egret.Bitmap,parseInt(this.isSelectMiusic)?this.cgMusic.texture=this.ocss.getTexture("sa_22"):(this.cgMusic.texture=this.ocss.getTexture("sa_29"),egret.localStorage.setItem("isSelectMiusic","1")),this.cgMusic.x=(egret.MainContext.instance.stage.stageWidth-this.cgMusic.width)/2,this.cgMusic.y=300,this.cgMusic.visible=!0,this.cgMusic.touchEnabled=!0,this.addChild(this.cgMusic),this.xxxrto=new egret.Bitmap,this.xxxrto.texture=this.ocss.getTexture("sa_9"),this.xxxrto.scaleX=1.4,this.xxxrto.scaleY=1.4,this.xxxrto.x=egret.MainContext.instance.stage.stageWidth/2-470,this.xxxrto.y=245,this.xxxrto.visible=!0,this.addChild(this.xxxrto),this.touxian=new egret.Bitmap,this.touxian.x=(egret.MainContext.instance.stage.stageWidth-this.touxian.width)/2-380,this.touxian.y=262,this.touxian.visible=!0,this.touxian.touchEnabled=!0,this.addChild(this.touxian);var e=new egret.Shape;e.graphics.beginFill(255),e.graphics.drawCircle(50,50,50),e.graphics.endFill(),e.anchorOffsetX=50,e.anchorOffsetY=50,e.x=(egret.MainContext.instance.stage.stageWidth-this.touxian.width)/2-380,e.y=262,this.addChild(e),this.touxian.mask=e,this.rePlay=new egret.Bitmap,this.rePlay.texture=this.ocss.getTexture("sa_23"),this.rePlay.x=(egret.MainContext.instance.stage.stageWidth-this.rePlay.width)/2,this.rePlay.y=420,this.rePlay.visible=!0,this.rePlay.touchEnabled=!0,this.addChild(this.rePlay),this.gock=new egret.Bitmap,this.gock.texture=this.ocss.getTexture("sa_25"),this.gock.x=(egret.MainContext.instance.stage.stageWidth-this.gock.width)/2-350,this.gock.y=480,this.gock.visible=!0,this.gock.touchEnabled=!0,this.addChild(this.gock),this.goshare=new egret.Bitmap,this.goshare.texture=this.ocss.getTexture("sa_24"),this.goshare.x=(egret.MainContext.instance.stage.stageWidth-this.goshare.width)/2+350,this.goshare.y=480,this.goshare.visible=!0,this.goshare.touchEnabled=!0,this.addChild(this.goshare),this.rePlay.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.rePlayed()},this),this.cgMusic.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){if(this.isToMusic){this.cgMusic.texture=this.ocss.getTexture("sa_22"),this.isToMusic=!1;var e=this.oParent.startLayer;e.musicPlay.texture=e.occ.getTexture("sa_5"),e.music.isOpenMusic=!0,e.oParent.isOpenMusic=!0,this.rodomMusic()}},this),this.goshare.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){callJsShareFun(2)},this),this.gock.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.visible=!1,this.oParent.score.visible=!0,this.oParent.gold.visible=!0,this.pplay.visible=!0,this.oParent.GameoverLayer.visible=!0,this.pplay.hidePops(),this.pplay.showPops(4),this.oParent.musicChose=3,this.oParent.MisicUl.stopMiuc(),this.oParent.MisicUl.playMusic(),callJsShowUpLoadBotton(1)},this)},i.Mcmap=function(){this.cgMusic.texture=this.ocss.getTexture("sa_29")},i.rodomMusic=function(){var t=Math.floor(Math.random()*(this.oParent.micArrList.length-1))+1;this.romCur=t,InterfaceData.musicId=t,callJsMusicIdFun(InterfaceData.musicId);var e=this.oParent.micArrList[t].yy[0],s=this.oParent.micArrList[t].yy[1];this.oParent.MisicUl.changeMusic(e,s)},i.rePlayed=function(){if(this.romCur){var t=this.oParent.micArrList[this.romCur].yy[0],e=this.oParent.micArrList[this.romCur].yy[1];this.oParent.MisicUl.changeMusic(t,e)}},i.addTx=function(t){this.pplay=t,RES.getResByUrl(InterfaceData.photos,function(t){var e=t;this.touxian.texture=e,this.touxian.width=100,this.touxian.height=100,this.touxian.anchorOffsetX=50,this.touxian.anchorOffsetY=50},this,RES.ResourceItem.TYPE_IMAGE)},e}(egret.Sprite);egret.registerClass(SoundsCtrol,"SoundsCtrol");var Square=function(t){function e(){t.call(this),this.square_json=RES.getRes("square_json"),this.square_png=RES.getRes("square_png"),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight,this.leftSize=200,this.stepSize=150,this.lastSquarePos=0,this.squarePosY=372,this.moveSize=0,this.stepCount=0,this.squareArr=[],this.ixxd=0,this.person=null,this.gold=null,this.controls=null,this.stepScore=0,this.delay=2e3,this.isMusicEnd=!0,this.t3=new egret.Timer(this.delay,1)}__extends(e,t);var s=(__define,e),i=s.prototype;return i.init=function(t){this.oPrent=t,this.addFirstQueeSquare()},i.addFirstQueeSquare=function(){this.t3.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.failed,this),this.t3.stop();var t=this.stageW-this.leftSize,e=(Math.floor(t/this.stepSize)+2,this);this.person=this.oPrent.person,this.gold=this.oPrent.gold,this.scoreClass=this.oPrent.score,this.music=this.oPrent.MisicUl;for(var s=0;60>s;s++)!function(t){e.creatMovieCilp(t)}(s)},i.creatMovieCilp=function(t){var e=new egret.MovieClipDataFactory(this.square_json,this.square_png);this.square_mc=new egret.MovieClip(e.generateMovieClipData("broken")),this.square_mc.anchorOffsetX=51,this.square_mc.anchorOffsetY=41,this.square_mc.name="mc_"+t,this.addChild(this.square_mc),this.squareArr.push(this.square_mc),this.setMcPosition(this.square_mc,t)},i.setMcPosition=function(t,e){var s,i,h=1*Math.random();s=h>=.7?2:1,e>=1?(i=this.lastSquarePos+s*this.stepSize,t.step=s):i=this.leftSize,t.x=i,t.idx=this.ixxd,t.y=this.squarePosY,this.hasAddGold(t,e),this.lastSquarePos=i,this.ixxd++},i.hasAddGold=function(t,e){var s=100*Math.random(),i=!1;i=s>20?!1:!0,i&&0!=e?(t.gold=!0,this.gold.addSquareGold(t,this)):t.gold=!1},i.squareSake=function(t,e){function s(){n++;var e=n%3;t.x=a[e][0],t.y=a[e][1]}var i=new egret.Timer(100,0),h=new egret.Timer(e,1);this.t3.reset();var o=this,n=0,a=[[t.x,t.y],[t.x-2,t.y-2],[t.x+2,t.y-2]];i.addEventListener(egret.TimerEvent.TIMER,s,this),i.start(),h.addEventListener(egret.TimerEvent.TIMER,function(){},this),h.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){i.removeEventListener(egret.TimerEvent.TIMER,s,this),h.removeEventListener(egret.TimerEvent.TIMER,function(){},this),t.x=a[0][0],t.y=a[0][1],o.squareBloken(t)},this),i.start(),h.start(),this.t3.start()},i.failed=function(){this.oPrent.control.isNext=!1,this.t3.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.failed,this);var t=egret.Tween.get(this.person);if(this.isMusicEnd){this.music.changeMusic(this.oPrent.micArrList[this.oPrent.MusicCurId].three[0],this.oPrent.micArrList[this.oPrent.MusicCurId].three[1]);var e=this;this.music.callback=function(){e.music.callback=null,e.oPrent.musicChose=3,e.music.stopMiuc(),e.music.playMusic()}}t.to({y:this.person.y+520},500).call(function(){this.parent.gameOver()})},i.squareBloken=function(t){var e=this,s=egret.Tween.get(t);s.to({y:this.squarePosY+280},350).call(function(){e.removeChild(t)}),t.play()},i.run=function(t,e){var s,i,h,o,n=this.moveSize-e*this.stepSize,a=egret.Tween.get(this);if(this.controls=t,this.stepCount++,i=this.squareArr[this.stepCount],this.t3.stop(),1==e){if(o=this.stepCount,h=this.squareArr[o],s=-(h.x-this.leftSize),n==s)this.isMusicEnd&&this.music.changeMusic(this.oPrent.micArrList[this.oPrent.MusicCurId].one[0],this.oPrent.micArrList[this.oPrent.MusicCurId].one[1]);else if(this.isMusicEnd){this.music.changeMusic(this.oPrent.micArrList[this.oPrent.MusicCurId].three[0],this.oPrent.micArrList[this.oPrent.MusicCurId].three[1]);var r=this;this.music.callback=function(){r.music.callback=null,r.oPrent.musicChose=3,r.music.stopMiuc(),r.music.playMusic()}}}else if(o=2==i.step?this.stepCount:this.stepCount+1,h=this.squareArr[o],s=-(h.x-this.leftSize),this.stepCount=o,n==s)this.isMusicEnd&&this.music.changeMusic(this.oPrent.micArrList[this.oPrent.MusicCurId].two[0],this.oPrent.micArrList[this.oPrent.MusicCurId].two[1]);else if(this.isMusicEnd){this.music.changeMusic(this.oPrent.micArrList[this.oPrent.MusicCurId].three[0],this.oPrent.micArrList[this.oPrent.MusicCurId].three[1]);var r=this;this.music.callback=function(){r.music.callback=null,r.oPrent.musicChose=3,r.music.stopMiuc(),r.music.playMusic()}}this.person.playStep(e),this.delay=this.delay-this.stepScore/50*20,this.delay<200?this.delay=200:this.delay=this.delay,this.t3.delay=this.delay,a.to({x:n},160).call(function(){if(n==s)1==e?this.stepScore++:this.stepScore+=3,this.gold.delGold(h),this.scoreClass.TotalScore(this.stepScore),this.squareSake(h,this.delay),t.isNext=!0;else{var i=egret.Tween.get(this.person);i.to({y:this.person.y+520},500).call(function(){this.parent.gameOver()}),t.isNext=!1}var o=Math.floor(this.stepCount/50);if(o!=this.addCount){this.addCount=o;for(var a=1;51>a;a++)this.creatMovieCilp(a)}this.moveSize=n})},e}(egret.Sprite);egret.registerClass(Square,"Square");var StartLayer=function(t){function e(){t.call(this),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight,this.isko=!1,this.sy_json=RES.getRes("sy_json"),this.sy_png=RES.getRes("sy_png")}__extends(e,t);var s=(__define,e),i=s.prototype;return i.createUl=function(t){this.oParent=t,this.music=t.MisicUl,this.shp=new egret.Shape,this.shp.graphics.beginFill(16711680,1),this.shp.graphics.drawRect(0,0,this.stageW,this.stageH),this.shp.graphics.endFill(),this.shp.alpha=0,this.shp.touchEnabled=!0,this.addChild(this.shp);var e=new egret.MovieClipDataFactory(this.sy_json,this.sy_png);this.sy_mc=new egret.MovieClip(e.generateMovieClipData("syc")),this.sy_mc.x=egret.MainContext.instance.stage.stageWidth-this.sy_mc.width-40,this.sy_mc.y=130,this.sy_mc.play(-1),this.addChild(this.sy_mc),this.shp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){t.stopImmediatePropagation()},this),this.occ=RES.getRes("ocs_json"),this.startBtn=new egret.Bitmap,this.startBtn.texture=this.occ.getTexture("sa_2"),this.startBtn.x=(egret.MainContext.instance.stage.stageWidth-this.startBtn.width)/2,this.startBtn.y=535,this.startBtn.touchEnabled=!0,this.addChild(this.startBtn),this.lwsays=new egret.Bitmap,this.lwsays.texture=this.occ.getTexture("sa_1"),this.lwsays.scaleX=.9,this.lwsays.scaleY=.9,this.lwsays.x=(egret.MainContext.instance.stage.stageWidth-this.lwsays.width)/2+50,this.lwsays.y=32,this.addChild(this.lwsays),this.musicPlay=new egret.Bitmap,t.isOpenMusic?this.musicPlay.texture=this.occ.getTexture("sa_5"):this.musicPlay.texture=this.occ.getTexture("sa_4"),this.musicPlay.x=egret.MainContext.instance.stage.stageWidth-this.musicPlay.width-25,this.musicPlay.y=30,this.musicPlay.touchEnabled=!0,this.addChild(this.musicPlay),1!=t.musicChose?(this.startBtn.visible=!1,this.shp.visible=!1,this.lwsays.visible=!1,this.sy_mc.visible=!1):(this.startBtn.visible=!0,this.shp.visible=!0,this.lwsays.visible=!0,this.sy_mc.visible=!0),this.musicPlay.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.OpenMic(t)},this)},i.OpenMic=function(t){t.stopImmediatePropagation(),this.isko=!this.isko,this.isko?(this.musicPlay.texture=this.occ.getTexture("sa_5"),this.sy_mc.visible=!1):(this.musicPlay.texture=this.occ.getTexture("sa_4"),this.sy_mc.visible=!0),this.music.isOpenMusic=this.isko,this.oParent.isOpenMusic=this.isko,this.music.playMusic()},e}(egret.Sprite);egret.registerClass(StartLayer,"StartLayer");